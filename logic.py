def check_comprehensive(cap, db, proj, is_restricted, is_duplicated, is_default, is_suitability):
    # 기존 재무 비율 계산
    debt_ratio = (db / cap * 100) if cap > 0 else 999
    results = []

    # --- [1] 비재무(자격) 요건 검토 ---
    
    # 1. 참여제한 여부 (지침 제1호)
    if is_restricted == "해당함":
        results.append({
            "항목": "참여제한(제재조치)",
            "원인": "현재 국가연구개발사업 참여제한 중인 기관 또는 책임자가 포함되어 있습니다. [지침 제1호]",
            "해결책": "접수 마감일 전까지 제재 기간이 종료되지 않는 경우 지원이 불가합니다. [cite: 49]"
        })

    # 2. 과제 중복성 (지침 제3호)
    if is_duplicated == "중복됨":
        results.append({
            "항목": "과제 중복성",
            "원인": "기개발/기지원된 과제와 동일하거나 유사한 과제로 판단됩니다. [지침 제3호]",
            "해결책": "중복성이 의심되는 경우 차별성을 입증하거나, 기존 과제와 다른 목표를 제시해야 합니다. [cite: 53]"
        })

    # 3. 채무불이행 및 부실위험 (지침 제5호)
    if is_default == "해당함":
        results.append({
            "항목": "채무불이행",
            "원인": "국세/지방세 체납 또는 채무불이행자 명부에 등재된 상태입니다. [지침 제5호]",
            "해결책": "신용회복위원회 지원 등 예외 사유가 아니라면 체납 처분을 해소해야 합니다. [cite: 64]"
        })

    # 4. 공고 적합성 (지침 제2호)
    if is_suitability == "부적합":
        results.append({
            "항목": "신청 자격(공고 적합성)",
            "원인": "공고문에 명시된 신청 자격 요건을 충족하지 못했습니다. [지침 제2호]",
            "해결책": "공고문의 '신청자격' 란을 다시 확인하시어 요건을 갖추시기 바랍니다. [cite: 50, 51]"
        })

    # --- [2] 재무 요건 검토 (기존 로직) ---
    
    # 5. 자본잠식 (지침 제5호 6번)
    if cap <= 0:
        results.append({
            "항목": "자본전액잠식",
            "원인": "최근 결산 기준 자본총계가 0 이하입니다. [cite: 67]",
            "해결책": "해당 공동연구기관 제외 요청 또는 사유 해소 증빙이 필요합니다."
        })

    # 6. 부채비율 (지침 제5호 5번)
    if debt_ratio >= 500:
        results.append({
            "항목": "부채비율 500% 초과",
            "원인": f"부채비율({debt_ratio:.1f}%)이 기준치를 초과했습니다. [cite: 64]",
            "해결책": "창업 5년 미만 등 예외 조건에 해당하는지 확인하십시오."
        })

    # 7. 3책 5공 (지침 제6호)
    if proj > 3:
        results.append({
            "항목": "3책 5공 위반",
            "원인": "연구책임자 수행 과제 수가 3개를 초과합니다. [cite: 74]",
            "해결책": "참여율 조정 또는 책임자 변경이 필요합니다."
        })

    return results
